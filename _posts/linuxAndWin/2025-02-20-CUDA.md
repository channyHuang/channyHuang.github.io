---
layout: default
title: CUDA
categories:
- Linux
tags:
- Server
- Linux
---
//Description: 记录使用在linux上使用CUDA

//Create Date: 2025-02-20 14:20:28

//Author: channy

[toc]

# CUDA多版本切换
## 版本查看
```sh
$ ls /usr/local
bin   cuda-12    cuda-12.5  games    lib  sbin   src
cuda  cuda-12.1  etc        include  man  share
```

```sh
$ nvcc -V
nvcc: NVIDIA (R) Cuda compiler driver
Copyright (c) 2005-2024 NVIDIA Corporation
Built on Wed_Apr_17_19:19:55_PDT_2024
Cuda compilation tools, release 12.5, V12.5.40
Build cuda_12.5.r12.5/compiler.34177558_0
```

```sh
$ nvidia-smi
Thu Feb 20 14:10:24 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 555.42.02              Driver Version: 555.42.02      CUDA Version: 12.5     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  NVIDIA GeForce RTX 3090        Off |   00000000:55:00.0  On |                  N/A |
| 53%   68C    P0            201W /  350W |   16523MiB /  24576MiB |     11%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI        PID   Type   Process name                              GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|    0   N/A  N/A      1957      G   /usr/lib/xorg/Xorg                             35MiB |
|    0   N/A  N/A      2799      G   /usr/lib/xorg/Xorg                            163MiB |
|    0   N/A  N/A      2937      G   /usr/bin/gnome-shell                           54MiB |
|    0   N/A  N/A      3498      G   ...sion,SpareRendererForSitePerProcess         81MiB |
|    0   N/A  N/A     63928      C   python3                                     16138MiB |
+-----------------------------------------------------------------------------------------+

```

## 版本安装
[CUDA-Toolkit](https://developer.nvidia.com/cuda-toolkit-archive)
多个版本安装过程中去掉`Driver`显卡驱动安装

## 版本切换
添加到update-alternatives
```sh
sudo update-alternatives --install /usr/local/cuda cuda /usr/local/cuda-12.1 121
sudo update-alternatives --install /usr/local/cuda cuda /usr/local/cuda-12.5 125
```
切换
```sh
$ sudo update-alternatives --config cuda
update-alternatives --config cuda
There are 2 choices for the alternative cuda (providing /usr/local/cuda).

  Selection    Path                  Priority   Status
------------------------------------------------------------
* 0            /usr/local/cuda-12.5   125       auto mode
  1            /usr/local/cuda-12     10        manual mode
  2            /usr/local/cuda-12.5   125       manual mode

Press <enter> to keep the current choice[*], or type selection number: 
```
切换后验证`nvcc -V`

